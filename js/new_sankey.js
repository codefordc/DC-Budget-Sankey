d3.mytimer=function(e,t,r){var n=arguments.length;2>n&&(t=0),3>n&&(r=Date.now());var a=r+t,o={c:e,t:a,f:!1,n:null};d3_timer_queueTail?d3_timer_queueTail.n=o:d3_timer_queueHead=o,d3_timer_queueTail=o,d3_timer_interval||(d3_timer_timeout=clearTimeout(d3_timer_timeout),d3_timer_interval=1,d3_timer_frame(d3_timer_step))},myData=[{source:"General Revenue",target:"General",value:3446022968},{source:"General Revenue",target:"RI Higher Education Assistance Auth",value:147e3},{source:"Federal Funds",target:"General",value:2728339814},{source:"Federal Funds",target:"Intermodal Surface Trans",value:399514755},{source:"Federal Funds",target:"RI Higher Education Assistance Auth",value:15465693},{source:"Restricted Receipts",target:"General",value:270058775},{source:"Restricted Receipts",target:"Intermodal Surface Trans",value:12352761},{source:"Restricted Receipts",target:"University - Colleges",value:644e3},{source:"Operating Transfers from Other Funds",target:"General",value:48423478},{source:"Operating Transfers from Other Funds",target:"RI Capital Plan Fund",value:267335029},{source:"Debt",target:"11-",value:4747781},{source:"Debt",target:"Certificates of Participation",value:18656925},{source:"Debt",target:"Garvee/Motor Fuel Tax Bond Issues",value:3203e4},{source:"Other Funds",target:"General",value:12330081},{source:"Other Funds",target:"Intermodal Surface Trans",value:253240247},{source:"Other Funds",target:"RI Temporary Disability Insurance",value:198706124},{source:"Other Funds",target:"Bond Capital",value:155363},{source:"Other Funds",target:"Garvee/Motor Fuel Tax Bond Issues",value:10928029},{source:"Other Funds",target:"State Lottery",value:692306302},{source:"Other Funds",target:"Assessed Fringe Benefits Admin",value:37123794},{source:"Other Funds",target:"Central Utilities",value:14244902},{source:"Other Funds",target:"Central Mail",value:5617173},{source:"Other Funds",target:"Centrex",value:4080029},{source:"Other Funds",target:"Automotive Maintenance",value:13733063},{source:"Other Funds",target:"Central Distribution Center",value:6739558},{source:"Other Funds",target:"Correctional Industries",value:7704793},{source:"Other Funds",target:"Records Center",value:882436},{source:"Other Funds",target:"Surplus Property Internal Service Fund",value:2500},{source:"Other Funds",target:"Health Insurance Fund",value:235532939},{source:"Other Funds",target:"Capitol Police Fund",value:1060301},{source:"Other Funds",target:"Employment Security Trust",value:2185e5},{source:"Other Funds",target:"Retired Employees Health Fund",value:49089615},{source:"Other Funds",target:"Bog Retiree Health Fund",value:2536462},{source:"Other Funds",target:"Ripta Health Fund",value:14594818},{source:"Other Funds",target:"Permanent School",value:359e3},{source:"Other Funds",target:"Touro Jewish Synagogue",value:2e5},{source:"Other Funds",target:"Teacher Retiree Health Fund",value:7531279},{source:"Other Funds",target:"State Police Retiree Health Fund",value:3073102},{source:"Other Funds",target:"Legislative Retiree Health Fund",value:772532},{source:"Other Funds",target:"Judicial Retiree Health",value:931493},{source:"Other Funds",target:"University - Colleges",value:849745005},{source:"Other Funds",target:"RI Higher Education Assistance Auth",value:8339268},{source:"Other Funds",target:"RI Industrial-Recreational Building Auth",value:562975},{source:"General",target:"General Assembly - Constitution",value:37781122},{source:"General",target:"Executive Dept",value:4511489},{source:"General",target:"Office of Lieutenant Governor",value:1084499},{source:"General",target:"Military Staff",value:17057696},{source:"General",target:"RI Emergency Management Agency",value:20450976},{source:"General",target:"Governor's Commission on Disabilities",value:508257},{source:"General",target:"Commission on the Deaf & Hard of Hearing",value:471540},{source:"General",target:"RI Council on the Arts",value:2912011},{source:"General",target:"Historical Preservation and Heritage Commission",value:4002933},{source:"General",target:"Office of Health and Human Services",value:2391356418},{source:"General",target:"Board of Elections",value:4137950},{source:"General",target:"RI Ethics Commission",value:1576550},{source:"General",target:"Public Utilities Commission",value:8459886},{source:"General",target:"Office of The Child Advocate",value:658262},{source:"General",target:"RI Commission For Human Rights",value:1471587},{source:"General",target:"Office of The Mental Health Advocate",value:491504},{source:"General",target:"Office of Public Defender",value:11325714},{source:"General",target:"Coastal Resources Management Council",value:4197121},{source:"General",target:"RI Atomic Energy Commission",value:1167197},{source:"General",target:"Public Telecommunications Auth",value:425e3},{source:"General",target:"RI Higher Education Assistance Auth-Agency",value:45e5},{source:"General",target:"Dept of State",value:7837670},{source:"General",target:"Dept of Attorney General",value:36365551},{source:"General",target:"Treasury Dept",value:35012306},{source:"General",target:"Dept of Admin",value:398834213},{source:"General",target:"Dept of Human Services",value:649364755},{source:"General",target:"Dept of Business Regulation",value:12931738},{source:"General",target:"Elementary and Secondary Education",value:1239741320},{source:"General",target:"Dept of Labor and Training",value:101961244},{source:"General",target:"Dept of Environmental Management",value:86589407},{source:"General",target:"Dept of Health",value:122531163},{source:"General",target:"Dept of Behavioral Healthcare, Developmental Disabilities and Hospitals",value:357867906.3},{source:"General",target:"Dept of Corrections",value:188828720},{source:"General",target:"Dept of Children, Youth, and Families",value:207461164},{source:"General",target:"Dept of Revenue",value:117685449},{source:"General",target:"Dept of Public Safety",value:119386228},{source:"General",target:"Public Higher Education",value:9655716},{source:"General",target:"University of RI",value:93462727},{source:"General",target:"RI College",value:48819627},{source:"General",target:"Community College of RI",value:48364428},{source:"General",target:"Judicial Dept - Constitution",value:103926072},{source:"11-",target:"Dept of Revenue",value:4747781},{source:"Intermodal Surface Trans",target:"Dept of Transportation",value:665107763},{source:"RI Temporary Disability Insurance",target:"Treasury Dept",value:220608},{source:"RI Temporary Disability Insurance",target:"Dept of Labor and Training",value:198485516},{source:"RI Capital Plan Fund",target:"Military Staff",value:139e4},{source:"RI Capital Plan Fund",target:"RI Emergency Management Agency",value:167e3},{source:"RI Capital Plan Fund",target:"Governor's Commission on Disabilities",value:1e6},{source:"RI Capital Plan Fund",target:"Historical Preservation and Heritage Commission",value:19e5},{source:"RI Capital Plan Fund",target:"Coastal Resources Management Council",value:75e4},{source:"RI Capital Plan Fund",target:"RI Atomic Energy Commission",value:1e5},{source:"RI Capital Plan Fund",target:"Dept of State",value:5e5},{source:"RI Capital Plan Fund",target:"Dept of Attorney General",value:3e5},{source:"RI Capital Plan Fund",target:"Dept of Admin",value:132547322},{source:"RI Capital Plan Fund",target:"Dept of Human Services",value:165e3},{source:"RI Capital Plan Fund",target:"Dept of Transportation",value:36323529},{source:"RI Capital Plan Fund",target:"Elementary and Secondary Education",value:5887328},{source:"RI Capital Plan Fund",target:"Dept of Labor and Training",value:2005996},{source:"RI Capital Plan Fund",target:"Dept of Environmental Management",value:17059170},{source:"RI Capital Plan Fund",target:"Dept of Behavioral Healthcare, Developmental Disabilities and Hospitals",value:7207286},{source:"RI Capital Plan Fund",target:"Dept of Corrections",value:19527438},{source:"RI Capital Plan Fund",target:"Dept of Children, Youth, and Families",value:2911831},{source:"RI Capital Plan Fund",target:"Dept of Public Safety",value:6799959},{source:"RI Capital Plan Fund",target:"University of RI",value:1847e4},{source:"RI Capital Plan Fund",target:"RI College",value:6834865},{source:"RI Capital Plan Fund",target:"Community College of RI",value:4138305},{source:"RI Capital Plan Fund",target:"Judicial Dept - Constitution",value:135e4},{source:"Bond Capital",target:"Dept of Admin",value:155363},{source:"Certificates of Participation",target:"Dept of Attorney General",value:1e6},{source:"Certificates of Participation",target:"Dept of Admin",value:6370221},{source:"Certificates of Participation",target:"Elementary and Secondary Education",value:6125876},{source:"Certificates of Participation",target:"Dept of Revenue",value:4140663},{source:"Certificates of Participation",target:"University of RI",value:1020165},{source:"Garvee/Motor Fuel Tax Bond Issues",target:"Dept of Transportation",value:42958029},{source:"State Lottery",target:"Dept of Revenue",value:692306302},{source:"Assessed Fringe Benefits Admin",target:"Dept of Admin",value:37123794},{source:"Central Utilities",target:"Dept of Admin",value:14244902},{source:"Central Mail",target:"Dept of Admin",value:5617173},{source:"Centrex",target:"Dept of Admin",value:4080029},{source:"Automotive Maintenance",target:"Dept of Admin",value:13733063},{source:"Central Distribution Center",target:"Dept of Corrections",value:6739558},{source:"Correctional Industries",target:"Dept of Corrections",value:7704793},{source:"Records Center",target:"Dept of State",value:882436},{source:"Surplus Property Internal Service Fund",target:"Dept of Admin",value:2500},{source:"Health Insurance Fund",target:"Dept of Admin",value:235532939},{source:"Capitol Police Fund",target:"Dept of Public Safety",value:1060301},{source:"Employment Security Trust",target:"Dept of Labor and Training",value:2185e5},{source:"Retired Employees Health Fund",target:"Dept of Admin",value:49089615},{source:"Bog Retiree Health Fund",target:"Dept of Admin",value:2536462},{source:"Ripta Health Fund",target:"Dept of Admin",value:14594818},{source:"Permanent School",target:"Elementary and Secondary Education",value:359e3},{source:"Touro Jewish Synagogue",target:"Treasury Dept",value:2e5},{source:"Teacher Retiree Health Fund",target:"Dept of Admin",value:7531279},{source:"State Police Retiree Health Fund",target:"Dept of Admin",value:3073102},{source:"Legislative Retiree Health Fund",target:"Dept of Admin",value:772532},{source:"Judicial Retiree Health",target:"Dept of Admin",value:931493},{source:"University - Colleges",target:"University of RI",value:631426781},{source:"University - Colleges",target:"RI College",value:115536249},{source:"University - Colleges",target:"Community College of RI",value:103425975},{source:"RI Higher Education Assistance Auth",target:"RI Higher Education Assistance Auth-Agency",value:23951961},{source:"RI Industrial-Recreational Building Auth",target:"RI Industrial - Recreational Building Auth",value:562975}];var margin={top:50,right:210,bottom:10,left:10},width=1160-margin.left-margin.right,height=630-margin.top-margin.bottom;d3.sankey=function(){"use strict";function e(){f.forEach(function(e){e.sourceLinks=[],e.targetLinks=[]}),v.forEach(function(e){var t=e.source,r=e.target;"number"==typeof t&&(t=e.source=f[e.source]),"number"==typeof r&&(r=e.target=f[e.target]),t.sourceLinks.push(e),r.targetLinks.push(e)})}function t(){f.forEach(function(e){e.sTag=[],e.tTag=[]}),v.forEach(function(e){var t=e.source,r=e.target;"number"==typeof t&&(t=e.source),"number"==typeof r&&(r=e.target),t.tTag.push(e.tt),r.sTag.push(e.st)})}function r(){f.forEach(function(e){e.value=Math.max(d3.sum(e.sourceLinks,u),d3.sum(e.targetLinks,u))})}function n(){for(var e,t=f,r=0;t.length;)e=[],t.forEach(function(t){t.x=r,t.dx=s,t.sourceLinks.forEach(function(t){e.push(t.target)})}),t=e,++r;g(r),p((width-s)/(r-1))}function a(e,t){var r=e.sort(function(e,r){var n=e[t],a=r[t];return a>n?1:n>a?-1:0});return r}function o(){function e(){var e=d3.min(r,function(e){return(d[1]-(e.length-1)*c)/d3.sum(e,u)});r.forEach(function(t){t.forEach(function(t,r){t.y=r,t.count=r,t.dy=t.value*e})}),v.forEach(function(t){t.dy=t.value*e})}function t(){r.forEach(function(e){var t,r,n,a=0,o=e.length;for(n=0;o>n;++n)t=e[n],r=a-t.y,r>0&&(t.y+=r),a=t.y+t.dy+c;if(r=a-c-d[1],r>0)for(a=t.y-=r,n=o-2;n>=0;--n)t=e[n],r=t.y+t.dy+c-a,r>0?t.y-=r:a=t.y})}var r=d3.nest().key(function(e){return e.x}).sortKeys(d3.ascending).entries(f).map(function(e){return e.values});a(r[0],"value"),a(r[1],"value"),a(r[2],"value"),e(),t()}function i(){function e(e,t){return e.source.y-t.source.y}function t(e,t){return e.target.y-t.target.y}f.forEach(function(r){r.sourceLinks.sort(t),r.targetLinks.sort(e)}),f.forEach(function(e){var t=0,r=0;e.sourceLinks.forEach(function(e){e.sy=t,t+=e.dy}),e.targetLinks.forEach(function(e){e.ty=r,r+=e.dy})})}function u(e){return e.value}var l={},s=24,c=8,d=[1,1],f=[],v=[],h=.35;l.nodeWidth=function(e){return arguments.length?void(s=+e):s},l.nodePadding=function(e){return arguments.length?void(c=+e):c},l.nodes=function(e){return arguments.length?void(f=e):f},l.links=function(e){return arguments.length?void(v=e):v},l.size=function(e){return arguments.length?void(d=e):d},l.layout=function(){e(),t(),r(),n(),o(),i()},l.curvature=function(e){return arguments.length?void(h=+e):h},l.relayout=function(){i()},l.link=function(){function e(e){var r=e.source.x+e.source.dx,n=e.target.x,a=d3.interpolateNumber(r,n),o=a(t),i=a(1-t),u=e.source.y+e.sy+e.dy/2,l=e.target.y+e.ty+e.dy/2;return"M"+r+","+u+"C"+o+","+u+" "+i+","+l+" "+n+","+l}var t=l.curvature();return e};var g=function(e){f.forEach(function(t){t.sourceLinks.length||(t.x=e-1)})},p=function(e){f.forEach(function(t){t.x*=e})};return l},function(){"use strict";function e(e,t){return e-t}function t(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function r(e,t){var r=e.sort(function(e,r){var n=e[t],a=r[t];return a>n?-1:n>a?1:0});return r}function n(e,t){var r=e.sort(function(e,r){var n=e[t],a=r[t];return a>n?1:n>a?-1:0});return r}function a(e,t){var r={},n=e.length,a=0;for(a=0;n>a;a++){var o=e[a][t];o in r||(r[o]=[]),r[o].push(e[a])}return r}function o(e){return Object.keys(e).map(function(t){return e[t]})}function i(e,t){var r=a(e,t),n=o(r);return n}function u(e,t,a,o){var u={},l="direction must be up or down, you have broken sort method in loop",s="up"===o?r:"down"===o?n:console.log(l);return u=i(e,t),u.forEach(function(e){s(e,a)}),u}function l(e){return!isNaN(e)&&e%2==0}function s(e){var t={eachNode:[],eachLink:[],fullList:[]},r=e,r=e.filter(function(e){return e.value>0});return r.sort(function(e,t){return t.value-e.value}),r.forEach(function(e){t.eachNode.push({name:e.source}),t.eachNode.push({name:e.target}),t.eachLink.push({source:e.source,target:e.target,sourceName:e.source,targetName:e.target,st:void 0,tt:void 0,theColor:void 0,num:0,type:"link",value:+e.value})}),t.eachNode=d3.keys(d3.nest().key(function(e){return e.name}).map(t.eachNode)),t.eachLink.forEach(function(e,r){t.eachLink[r].source=t.eachNode.indexOf(t.eachLink[r].source),t.eachLink[r].theColor=t.eachLink[r].source,t.eachLink[r].target=t.eachNode.indexOf(t.eachLink[r].target),t.eachLink[r].num=r}),t.eachLink.forEach(function(e,r){t.eachLink[r].st=t.eachLink[r].source,t.eachLink[r].tt=t.eachLink[r].target}),t.eachNode.forEach(function(e,r){t.eachNode[r]={name:e,theColor:V(r),strokeColor:void 0,num:r}}),t.eachNode.forEach(function(e,r){var n=d3.rgb(t.eachNode[r].theColor).darker(.3);t.eachNode[r].strokeColor=n}),t.eachLink.forEach(function(e,r){t.eachLink[r].theColor=t.eachNode[t.eachLink[r].theColor].theColor}),t}function c(){var e={};return e=d3.select("#chart").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")")}function d(e,t){t||(t=2);var r=Math.pow(10,t);return(parseInt(e*r)/r).toFixed(t)}function f(){var e={};return e=J.selectAll("#chart").data(O.links()).enter().append("path").attr("class","link").attr("d",O.link()).style(K.link_init_style).sort(function(e,t){return t.dy-e.dy})}function v(){var e={};return e=J.selectAll("#chart").data(w.eachNode).enter().append("rect").attr("transform",function(e){return"translate("+e.x+","+e.y+")"})}function h(e){return e.theColor}function g(e){return e.strokeColor}function p(){var e={};return e=J.append("g").selectAll("text").data(O.nodes()).enter().append("g").attr("class","words").attr("transform",function(e){return"translate("+e.x+","+e.y+")"})}function y(e){var t=100*e.dy,r=270>t?70:400;return r}function m(e,t,r,n){var a=t,o=e,i=d3.selectAll("rect"),u=a.sourceName,l=a.targetName;o.transition().duration(y(a)).style(K.link_hovered),d3.timer.flush(),r=d3.selectAll("path").filter(function(e){return e!==a}),r.transition().delay(650).duration(200).style(K.link_not_hovered),n=i.filter(function(e){var t=e.name===u,r=e.name===l;return t?!1:r?!1:!0}),n.transition("node").duration(750).style(Y.node_not_from_link),F(t)}function k(e){var t,r=d3.selectAll("path"),n=d3.selectAll("rect"),a=e;a.transition().style(K.link_reset_style_1).duration(1500).style(K.link_reset_style_2),d3.timer.flush(),t=r.filter(function(t){return t!==e.datum()}),t.transition().duration(900).style(K.link_init_style),n.transition("node").duration(1500).style(rt[0]),I()}function _(e,t,r,n,a){a=q.filter(function(e){var r=e.sourceName===t,n=e.targetName===t;return r&&n?!1:!0}),a.transition().delay(150).duration(850).style(K.link_not_from_node),n=q.filter(function(e){var r=e.sourceName===t,n=e.targetName===t;return r?!0:n?!0:!1}),n.transition().delay(110).duration(850).style(K.link_from_node),r=z.filter(function(t){return t!==e}),r.transition("node").delay(300).duration(800).style(Y.node_not_hovered)}function x(e,t,r,n,a){var o=t.name;e.transition("node").duration(2).style(Y.node_hovered),d3.timer.flush(),_(t,o,r,n,a),D(t)}function C(e){var t,r=d3.selectAll("path");e.transition("node").duration(250).style(Y.node_return),d3.timer.flush(),r.transition().delay(110).duration(940).style(K.link_init_style),t=z.filter(function(t){return t!==e.datum()}),t.transition("node").delay(500).style(Y.node_return),A()}function F(t){var r=t.st,n=t.tt,a=[].concat(r,n).sort(e),o=0,i=0,u={},l={},s=function(e){var t={};return e.num!==a[o]?t=e:void o++},c=function(e){var t={};return e.num===a[i]?(i++,e):void(t=e)};u=U.filter(c),u.transition("text").delay(900).style({"font-size":"17px",fill:"#000010","pointer-events":"none"}).attr("x",-6).attr("text-anchor","end").attr("transform",null).filter($.filterWidth).attr("x",6+O.nodeWidth()).attr({"text-anchor":"start","pointer-events":"none"}),l=U.filter(s),l.transition("text").delay(900).style({"fill-opacity":0,"pointer-events":"none"})}function R(e,t){var r=0,n=[],a=0;return e.forEach(function(e){e.forEach(function(e){e.y-r<t&&e.y-r>0&&l(a)?(n.push(e.num),a++):a=0,r=e.y})}),n}function D(t){var r=t.num,n=t.sTag,a=t.tTag,o=[].concat(r,n,a).sort(e),i=o.length,l=i>7?$.font_size_hover_group:"17px",s=0,c=0,d=0,f=[],v={},h={},g=function(e){var t={};return e.num!==o[s]?t=e:void s++},p=function(e){var t={};return e.num===o[d]?(d++,t=e,f.push(t),t):void 0};if(h=U.filter(g),h.transition("text").delay(1100).style({"fill-opacity":0,"pointer-events":"none"}),v=U.filter(p),12>i)v.transition("text").delay(1100).style({"font-size":l,fill:"#000010","pointer-events":"none"});else{var y=u(f,"x","y","up"),m=R(y,10).sort(e),k={},_=function(e){var t={};return e.num===m[c]?(c++,t=e):void 0};k=v.filter(_),v.transition("text").delay(1100).style({"font-size":l,fill:"#000010","pointer-events":"none"}),t.x>width/2||0===t.x?k.transition("text").delay(1100).attr("y",function(e){return e.dy/2}).attr({x:-6,"text-anchor":"end"}).style({"font-size":l,fill:"#000010","pointer-events":"none"}):k.transition("text").delay(1100).attr("y",function(e){return e.dy/2}).attr({x:6+O.nodeWidth(),"text-anchor":"start"}).style({"font-size":l,fill:"#000010","pointer-events":"none"})}}function I(){U.transition("text").delay(200).style({"fill-opacity":1,"font-size":$.font_size,fill:$.font_color,"pointer-events":"none"}).attr("x",-6).attr("text-anchor","end").attr("transform",null).filter($.filterWidth).attr("x",6+O.nodeWidth()).attr("text-anchor","start")}function A(){U.transition("text").delay(200).style({"fill-opacity":1,"font-size":$.font_size,fill:$.font_color,"pointer-events":"none"}).transition().attr("x",-6).attr("text-anchor","end").attr("transform",null).filter($.filterWidth).attr("x",6+O.nodeWidth()).attr("text-anchor","start")}function T(e){var t=e.datum();"link"!==t.type?x(e,t):m(e,t)}function E(e){"link"!==e.datum().type?C(e):k(e)}function G(){var e=d3.select(this);T(e)}function b(){var e=d3.select(this);E(e)}var O,w,P,H,L,S,N,z,M,B,W,U,j,J,q,Y,K,$,Q=(d3.format(",.0f"),function(e){return"$"+t(e)}),V=d3.scale.category20();w=s(myData),J=Object.create(c());var X=0,Z=0,et=0;O=Object.create(d3.sankey()),O.nodeWidth(30),O.nodePadding(4),O.size([width,height]),O.nodes(w.eachNode),O.links(w.eachLink),O.curvature(.01),O.layout(),L=O.nodes(),L.forEach(function(e,t){0===L[t].sTag.length&&(X+=L[t].value)}),S=O.nodes(),S.forEach(function(e,t){0===S[t].tTag.length&&(Z+=S[t].value)}),S.forEach(function(e,t){S[t].sTag.length>0&&S[t].tTag.length>0&&(et+=S[t].value)}),console.log("sankeyTotal",X),console.log("rightTotal",Z),console.log("middleTotal",et),console.log("1. sankeyTotal - middleTotal",X-et),console.log("2. middleTotal - rightTotal",et-Z),console.log("3. sankeyTotal - rightTotal",X-Z),P=Object.create(theTip()),H=Object.create(theTip());var tt=X;P.attr("class","theTip").html(function(e){var t=["<span class='titleTip'>",e.name.toUpperCase(),"</span>","<div class='drawline'></div>","<span class='totalTip'><strong>Total: </strong>",Q(e.value),"</span><br>","<span class='totalTip inRed'>",d(e.value/tt*100,3),"%","<span class='budget'> of Budget </span>","</span>"],r=t.join("");return r}),H.attr("class","theTip").html(function(e){var t=["<span class='titleTip'>",e.sourceName.toUpperCase()," → ",e.targetName,"</span>","<div class='drawline'></div>","<span class='totalTip'><strong>Total: </strong>",Q(e.value),"</span><br>","<span class='totalTip inRed'>",d(e.value/tt*100,3),"%","<span class='budget'> of Budget </span>","</span>"],r=t.join("");return r}),K={link_stroke_width:function(e){return Math.max(2,e.dy)},link_stroke_width_hover:function(e){return Math.max(4,e.dy)},link_color:function(e){return e.value>3e6?e.theColor:d3.rgb(e.theColor).darker(2.5)}},K.link_init_style={fill:"none","stroke-opacity":.15,"stroke-width":K.link_stroke_width,stroke:K.link_color},K.link_reset_style_1={"stroke-opacity":.15},K.link_reset_style_2={"stroke-width":K.link_stroke_width,stroke:K.link_color},K.link_hovered={"stroke-opacity":.6,"stroke-width":K.link_stroke_width_hover},K.link_not_hovered={"stroke-width":K.link_stroke_width,"stroke-opacity":.05},K.link_from_node={"stroke-opacity":.5,"stroke-width":K.link_stroke_width},K.link_not_from_node={"stroke-opacity":0,"stroke-width":K.link_stroke_width},N=Object.create(f()),q=d3.selectAll("path"),N.on("mouseover",G).on("mouseout",b).on("mouseenter",H.show).on("mouseleave",H.hide).on("touchstart",P.show),B=Object.create(v()),Y={};var rt=new Array(1),nt=function(e){var t=100*parseFloat(e.dy),r=270>t?"6px":"2px";return r};rt[0]={"stroke-opacity":1,"fill-opacity":.8,"shape-rendering":"crispEdges",overflow:"visible","stroke-width":"1px","z-index":1e3},Y.node_hovered={"fill-opacity":.7,"stroke-width":nt,"z-index":-100},Y.node_not_hovered={"stroke-width":"1px","stroke-opacity":1,"fill-opacity":1e-6},Y.node_from_link={"stroke-width":"1px","stroke-opacity":1,"fill-opacity":.6},Y.node_not_from_link={"stroke-opacity":.6,"stroke-width":"1px","fill-opacity":1e-6},Y.node_return={"fill-opacity":.8,"stroke-opacity":1,"stroke-width":"1px"},B.attr("class","node").attr("height",function(e){return e.dy}).attr("width",O.nodeWidth()).style("fill",h).style("stroke",g).style(rt[0]),B.on("mouseover",G).on("mouseout",b).on("mouseenter",P.show).on("mouseleave",P.hide).on("touchstart",P.show),z=d3.selectAll("rect"),M=Object.create(p()),$={},$.font_size=function(e){return e.dy>50?"15px":e.dy<=1.5?"0px":e.dy<=3?"8px":e.dy<=4?"9.5px":e.dy<=8?"11px":e.dy<=20?"12.5px":"13px"},$.font_size_hover_group=function(e){return e.dy>50?"17px":e.dy<=1.5?"9px":e.dy<=3?"10px":e.dy<=4?"10px":e.dy<=8?"13px":e.dy<=20?"14px":"16px"},$.font_color=function(e){return e.dy>50?"#000010":e.dy<=1.5?"#9AADB2":e.dy<=3?"#343F47":e.dy<=8?"#252D33":e.dy<=20?"#14191C":"#111417"},$.font_opacity=function(e){return e.dy<1.5?0:void 0},$.label_style={"font-size":$.font_size,fill:"#000010","pointer-events":"none","z-index":10,"text-shadow":"01px 0 #fff"},$.filterWidth=function(e){return e.x<width/2},M.append("text").attr("class","labels").attr("x",-6).attr("y",function(e){return e.dy>1.5?e.dy/2:4}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(e){return e.name}).style($.label_style).filter($.filterWidth).attr("x",6+O.nodeWidth()).attr("text-anchor","start"),U=d3.selectAll("text"),W=Object.create(p());var j=["Revenue Source","Fund","Agency"];W.append("text").attr("x",O.nodeWidth()).attr("text-anchor","end").attr("transform",null).text(function(e){return 0===e.y?j.shift():void 0}).attr("y",function(e){return e.y-1+"em"}).style("font-size","24px").style("font-weight",500).filter(function(e){return e.x<width/1.2}).attr("x",0).attr("text-anchor","start");var at=Object.create(p()),ot=new Array;ot.push(X),ot.push(et),ot.push(Z),console.log(ot),at.append("text").attr("x",O.nodeWidth()).attr("text-anchor","end").attr("transform",null).text(function(e){return 0===e.y?Q(ot.shift()):void 0}).attr("y",function(e){return e.y-.4+"em"}).style("font-size","16px").style("font-weight",100).filter(function(e){return e.x<width/1.2}).attr("x",0).attr("text-anchor","start"),J.call(theTip)}();