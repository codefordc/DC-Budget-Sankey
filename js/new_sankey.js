d3.mytimer=function(e,t,n){var r=arguments.length;if(r<2)t=0;if(r<3)n=Date.now();var i=n+t,s={c:e,t:i,f:false,n:null};if(d3_timer_queueTail)d3_timer_queueTail.n=s;else d3_timer_queueHead=s;d3_timer_queueTail=s;if(!d3_timer_interval){d3_timer_timeout=clearTimeout(d3_timer_timeout);d3_timer_interval=1;d3_timer_frame(d3_timer_step)}};myData=[{source:"General Revenue",target:"General",value:3446022968},{source:"General Revenue",target:"RI Higher Education Assistance Authority",value:147e3},{source:"Federal Funds",target:"General",value:2728339814},{source:"Federal Funds",target:"Intermodal Surface Trans",value:399514755},{source:"Federal Funds",target:"RI Higher Education Assistance Authority",value:15465693},{source:"Restricted Receipts",target:"General",value:270058775},{source:"Restricted Receipts",target:"Intermodal Surface Trans",value:12352761},{source:"Restricted Receipts",target:"University - Colleges",value:644e3},{source:"Operating Transfers From Other Funds",target:"General",value:48423478},{source:"Operating Transfers From Other Funds",target:"RI Capital Plan Fund",value:267335029},{source:"Debt",target:"11-",value:4747781},{source:"Debt",target:"Certificates Of Participation",value:18656925},{source:"Debt",target:"Garvee/Motor Fuel Tax Bond Issues",value:3203e4},{source:"Other Funds",target:"General",value:12330081},{source:"Other Funds",target:"Intermodal Surface Trans",value:253240247},{source:"Other Funds",target:"RI Temporary Disability Insurance",value:198706124},{source:"Other Funds",target:"Bond Capital",value:155363},{source:"Other Funds",target:"Garvee/Motor Fuel Tax Bond Issues",value:10928029},{source:"Other Funds",target:"State Lottery",value:692306302},{source:"Other Funds",target:"Assessed Fringe Benefits Administration",value:37123794},{source:"Other Funds",target:"Central Utilities",value:14244902},{source:"Other Funds",target:"Central Mail",value:5617173},{source:"Other Funds",target:"Centrex",value:4080029},{source:"Other Funds",target:"Automotive Maintenance",value:13733063},{source:"Other Funds",target:"Central Distribution Center",value:6739558},{source:"Other Funds",target:"Correctional Industries",value:7704793},{source:"Other Funds",target:"Records Center",value:882436},{source:"Other Funds",target:"Surplus Property Internal Service Fund",value:2500},{source:"Other Funds",target:"Health Insurance Fund",value:235532939},{source:"Other Funds",target:"Capitol Police Fund",value:1060301},{source:"Other Funds",target:"Employment Security Trust",value:2185e5},{source:"Other Funds",target:"Retired Employees Health Fund",value:49089615},{source:"Other Funds",target:"Bog Retiree Health Fund",value:2536462},{source:"Other Funds",target:"Ripta Health Fund",value:14594818},{source:"Other Funds",target:"Permanent School",value:359e3},{source:"Other Funds",target:"Touro Jewish Synagogue",value:2e5},{source:"Other Funds",target:"Teacher Retiree Health Fund",value:7531279},{source:"Other Funds",target:"State Police Retiree Health Fund",value:3073102},{source:"Other Funds",target:"Legislative Retiree Health Fund",value:772532},{source:"Other Funds",target:"Judicial Retiree Health",value:931493},{source:"Other Funds",target:"University - Colleges",value:849745005},{source:"Other Funds",target:"RI Higher Education Assistance Authority",value:8339268},{source:"Other Funds",target:"Ri Industrial-Recreational Building Authority",value:562975},{source:"General",target:"General Assembly - Constitution",value:37781122},{source:"General",target:"Executive Department",value:4511489},{source:"General",target:"Office Of Lieutenant Governor",value:1084499},{source:"General",target:"Military Staff",value:17057696},{source:"General",target:"RI Emergency Management Agency",value:20450976},{source:"General",target:"Governor's Commission On Disabilities",value:508257},{source:"General",target:"Commission On The Deaf & Hard Of Hearing",value:471540},{source:"General",target:"RI Council On The Arts",value:2912011},{source:"General",target:"Historical Preservation And Heritage Commission",value:4002933},{source:"General",target:"Office Of Health And Human Services",value:2391356418},{source:"General",target:"Board Of Elections",value:4137950},{source:"General",target:"RI Ethics Commission",value:1576550},{source:"General",target:"Public Utilities Commission",value:8459886},{source:"General",target:"Office Of The Child Advocate",value:658262},{source:"General",target:"RI Commission For Human Rights",value:1471587},{source:"General",target:"Office Of The Mental Health Advocate",value:491504},{source:"General",target:"Office Of Public Defender",value:11325714},{source:"General",target:"Coastal Resources Management Council",value:4197121},{source:"General",target:"RI Atomic Energy Commission",value:1167197},{source:"General",target:"Public Telecommunications Authority",value:425e3},{source:"General",target:"RI Higher Education Assistance Authority",value:45e5},{source:"General",target:"State",value:7837670},{source:"General",target:"Attorney General",value:36365551},{source:"General",target:"Treasury Department",value:35012306},{source:"General",target:"Administration",value:398834213},{source:"General",target:"Human Services",value:649364755},{source:"General",target:"Business Regulation",value:12931738},{source:"General",target:"Elementary And Secondary Education",value:1239741320},{source:"General",target:"Labor And Training",value:101961244},{source:"General",target:"Environmental Management",value:86589407},{source:"General",target:"Health",value:122531163},{source:"General",target:"Behavioral Healthcare Developmental Disabilities And Hospitals",value:357867906.3},{source:"General",target:"Corrections",value:188828720},{source:"General",target:"Children Youth And Families",value:207461164},{source:"General",target:"Revenue",value:117685449},{source:"General",target:"Public Safety",value:119386228},{source:"General",target:"Public Higher Education",value:9655716},{source:"General",target:"University Of RI",value:93462727},{source:"General",target:"RI College",value:48819627},{source:"General",target:"Community College Of RI",value:48364428},{source:"General",target:"Judicial Department - Constitution",value:103926072},{source:"11-",target:"Revenue",value:4747781},{source:"Intermodal Surface Trans",target:"Transportation",value:665107763},{source:"RI Temporary Disability Insurance",target:"Treasury Department",value:220608},{source:"RI Temporary Disability Insurance",target:"Labor And Training",value:198485516},{source:"RI Capital Plan Fund",target:"Military Staff",value:139e4},{source:"RI Capital Plan Fund",target:"RI Emergency Management Agency",value:167e3},{source:"RI Capital Plan Fund",target:"Governor'S Commission On Disabilities",value:1e6},{source:"RI Capital Plan Fund",target:"Historical Preservation And Heritage Commission",value:19e5},{source:"RI Capital Plan Fund",target:"Coastal Resources Management Council",value:75e4},{source:"RI Capital Plan Fund",target:"RI Atomic Energy Commission",value:1e5},{source:"RI Capital Plan Fund",target:"State",value:5e5},{source:"RI Capital Plan Fund",target:"Attorney General",value:3e5},{source:"RI Capital Plan Fund",target:"Administration",value:132547322},{source:"RI Capital Plan Fund",target:"Human Services",value:165e3},{source:"RI Capital Plan Fund",target:"Transportation",value:36323529},{source:"RI Capital Plan Fund",target:"Elementary And Secondary Education",value:5887328},{source:"RI Capital Plan Fund",target:"Labor And Training",value:2005996},{source:"RI Capital Plan Fund",target:"Environmental Management",value:17059170},{source:"RI Capital Plan Fund",target:"Behavioral Healthcare Developmental Disabilities And Hospitals",value:7207286},{source:"RI Capital Plan Fund",target:"Corrections",value:19527438},{source:"RI Capital Plan Fund",target:"Children Youth And Families",value:2911831},{source:"RI Capital Plan Fund",target:"Public Safety",value:6799959},{source:"RI Capital Plan Fund",target:"University Of RI",value:1847e4},{source:"RI Capital Plan Fund",target:"RI College",value:6834865},{source:"RI Capital Plan Fund",target:"Community College Of RI",value:4138305},{source:"RI Capital Plan Fund",target:"Judicial Department - Constitution",value:135e4},{source:"Bond Capital",target:"Administration",value:155363},{source:"Certificates Of Participation",target:"Attorney General",value:1e6},{source:"Certificates Of Participation",target:"Administration",value:6370221},{source:"Certificates Of Participation",target:"Elementary And Secondary Education",value:6125876},{source:"Certificates Of Participation",target:"Revenue",value:4140663},{source:"Certificates Of Participation",target:"University Of RI",value:1020165},{source:"Garvee/Motor Fuel Tax Bond Issues",target:"Transportation",value:42958029},{source:"State Lottery",target:"Revenue",value:692306302},{source:"Assessed Fringe Benefits Administration",target:"Administration",value:37123794},{source:"Central Utilities",target:"Administration",value:14244902},{source:"Central Mail",target:"Administration",value:5617173},{source:"Centrex",target:"Administration",value:4080029},{source:"Automotive Maintenance",target:"Administration",value:13733063},{source:"Central Distribution Center",target:"Corrections",value:6739558},{source:"Correctional Industries",target:"Corrections",value:7704793},{source:"Records Center",target:"State",value:882436},{source:"Surplus Property Internal Service Fund",target:"Administration",value:2500},{source:"Health Insurance Fund",target:"Administration",value:235532939},{source:"Capitol Police Fund",target:"Public Safety",value:1060301},{source:"Employment Security Trust",target:"Labor And Training",value:2185e5},{source:"Retired Employees Health Fund",target:"Administration",value:49089615},{source:"Bog Retiree Health Fund",target:"Administration",value:2536462},{source:"Ripta Health Fund",target:"Administration",value:14594818},{source:"Permanent School",target:"Elementary And Secondary Education",value:359e3},{source:"Touro Jewish Synagogue",target:"Treasury Department",value:2e5},{source:"Teacher Retiree Health Fund",target:"Administration",value:7531279},{source:"State Police Retiree Health Fund",target:"Administration",value:3073102},{source:"Legislative Retiree Health Fund",target:"Administration",value:772532},{source:"Judicial Retiree Health",target:"Administration",value:931493},{source:"University - Colleges",target:"University Of RI",value:631426781},{source:"University - Colleges",target:"RI College",value:115536249},{source:"University - Colleges",target:"Community College Of RI",value:103425975},{source:"RI Higher Education Assistance Authority",target:"54-RI Higher Education Assistance Authority",value:23951961}];var margin={top:30,right:210,bottom:10,left:10},width=1160-margin.left-margin.right,height=630-margin.top-margin.bottom;d3.sankey=function(){"use strict";function u(){i.forEach(function(e){e.sourceLinks=[];e.targetLinks=[]});s.forEach(function(e){var t=e.source,n=e.target;if(typeof t==="number"){t=e.source=i[e.source]}if(typeof n==="number"){n=e.target=i[e.target]}t.sourceLinks.push(e);n.targetLinks.push(e)})}function a(){i.forEach(function(e){e.sTag=[];e.tTag=[]});s.forEach(function(e){var t=e.source,n=e.target;if(typeof t==="number"){t=e.source}if(typeof n==="number"){n=e.target}t.tTag.push(e.tt);n.sTag.push(e.st)})}function f(){i.forEach(function(e){e.value=Math.max(d3.sum(e.sourceLinks,g),d3.sum(e.targetLinks,g))})}function h(){var e=i,n,r=0;while(e.length){n=[];e.forEach(function(e){e.x=r;e.dx=t;e.sourceLinks.forEach(function(e){n.push(e.target)})});e=n;++r}l(r);c((width-t)/(r-1))}function p(e,t){var n=e.sort(function(e,n){var r=e[t],i=n[t];return r<i?1:r>i?-1:0});return n}function d(e,t){var n=e.sort(function(e,n){var r=e[t],i=n[t];return r<i?-1:r>i?1:0});return n}function v(){function t(){var t=d3.min(e,function(e){return(r[1]-(e.length-1)*n)/d3.sum(e,g)});e.forEach(function(e){e.forEach(function(e,n){e.y=n;e.count=n;e.dy=e.value*t})});s.forEach(function(e){e.dy=e.value*t})}function o(){e.forEach(function(e){var t,i,s=0,o=e.length,u;for(u=0;u<o;++u){t=e[u];i=s-t.y;if(i>0){t.y+=i}s=t.y+t.dy+n}i=s-n-r[1];if(i>0){s=t.y-=i;for(u=o-2;u>=0;--u){t=e[u];i=t.y+t.dy+n-s;if(i>0){t.y-=i}else{s=t.y}}}})}var e=d3.nest().key(function(e){return e.x}).sortKeys(d3.ascending).entries(i).map(function(e){return e.values});p(e[0],"value");p(e[1],"value");p(e[3],"value");t();o()}function m(){function e(e,t){return e.source.y-t.source.y}function t(e,t){return e.target.y-t.target.y}i.forEach(function(n){n.sourceLinks.sort(t);n.targetLinks.sort(e)});i.forEach(function(e){var t=0,n=0;e.sourceLinks.forEach(function(e){e.sy=t;t+=e.dy});e.targetLinks.forEach(function(e){e.ty=n;n+=e.dy})})}function g(e){return e.value}var e={},t=24,n=8,r=[1,1],i=[],s=[],o=.35;e.nodeWidth=function(e){if(!arguments.length){return t}else{t=+e}};e.nodePadding=function(e){if(!arguments.length){return n}else{n=+e}};e.nodes=function(e){if(!arguments.length){return i}else{i=e}};e.links=function(e){if(!arguments.length){return s}else{s=e}};e.size=function(e){if(!arguments.length){return r}else{r=e}};e.layout=function(){u();a();f();h();v();m()};e.curvature=function(e){if(!arguments.length){return o}else{o=+e}};e.relayout=function(){m()};e.link=function(){function n(e){var n=e.source.x+e.source.dx,r=e.target.x,i=d3.interpolateNumber(n,r),s=i(t),o=i(1-t),u=e.source.y+e.sy+e.dy/2,a=e.target.y+e.ty+e.dy/2;return"M"+n+","+u+"C"+s+","+u+" "+o+","+a+" "+r+","+a}var t=e.curvature();return n};var l=function(e){i.forEach(function(t){if(!t.sourceLinks.length){t.x=e-1}})};var c=function(e){i.forEach(function(t){t.x*=e})};return e};(function(){"use strict";function x(e,t){return e-t}function T(e,t){return e-t}function N(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function C(e,t){var n=e.sort(function(e,n){var r=e[t],i=n[t];return r<i?-1:r>i?1:0});return n}function k(e,t){var n=e.sort(function(e,n){var r=e[t],i=n[t];return r<i?1:r>i?-1:0});return n}function L(e,t){var n={},r=e.length,i=0;for(i=0;i<r;i++){var s=e[i][t];if(!(s in n)){n[s]=[]}n[s].push(e[i])}return n}function A(e){return Object.keys(e).map(function(t){return e[t]})}function O(e,t){var n=L(e,t);var r=A(n);return r}function M(e,t,n,r){var i={},s="direction must be up or down, you have broken sort method in loop",o=r==="up"?C:r==="down"?k:console.log(s);i=O(e,t);i.forEach(function(e,t){o(e,n)});return i}function _(e){return!isNaN(e)&&e%2==0}function D(e,t){e=d3.rgb(e);t=d3.rgb(t);var n=e.r,r=e.g,i=e.b,s=t.r-n,o=t.g-r,u=t.b-i;return function(e){return"#"+d3_rgb_hex(Math.round(n+s*e))+d3_rgb_hex(Math.round(r+o*e))+d3_rgb_hex(Math.round(i+u*e))}}function P(e){var t={eachNode:[],eachLink:[],fullList:[]},n=e;var n=e.filter(function(e){return e["value"]>0});n.sort(function(e,t){return t.value-e.value});n.forEach(function(e){t.eachNode.push({name:e.source});t.eachNode.push({name:e.target});t.eachLink.push({source:e.source,target:e.target,sourceName:e.source,targetName:e.target,st:undefined,tt:undefined,theColor:undefined,num:0,type:"link",value:+e.value})});t.eachNode=d3.keys(d3.nest().key(function(e){return e.name}).map(t.eachNode));t.eachLink.forEach(function(e,n){t.eachLink[n].source=t.eachNode.indexOf(t.eachLink[n].source);t.eachLink[n].theColor=t.eachLink[n].source;t.eachLink[n].target=t.eachNode.indexOf(t.eachLink[n].target);t.eachLink[n].num=n});t.eachLink.forEach(function(e,n){t.eachLink[n].st=t.eachLink[n].source;t.eachLink[n].tt=t.eachLink[n].target});t.eachNode.forEach(function(e,n){t.eachNode[n]={name:e,theColor:S(n),strokeColor:undefined,num:n}});t.eachNode.forEach(function(e,n){var r=d3.rgb(t.eachNode[n].theColor).darker(.3);t.eachNode[n].strokeColor=r});t.eachLink.forEach(function(e,n){t.eachLink[n].theColor=t.eachNode[t.eachLink[n].theColor].theColor});return t}function H(){var e={};e=d3.select("#chart").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")");return e}function I(e,t){if(!t)t=2;var n=Math.pow(10,t);return(parseInt(e*n)/n).toFixed(t)}function R(){var t={};t=d.selectAll("#chart").data(e.links()).enter().append("path").attr("class","link").attr("d",e.link()).style(y.link_init_style).sort(function(e,t){return t.dy-e.dy});return t}function U(){var e={};e=d.selectAll("#chart").data(t.eachNode).enter().append("rect").attr("transform",function(e){return"translate("+e.x+","+e.y+")"});return e}function z(e,t){return e.theColor}function W(e){return e.strokeColor}function $(){var t={};t=d.append("g").selectAll("text").data(e.nodes()).enter().append("g").attr("class","words").attr("transform",function(e){return"translate("+e.x+","+e.y+")"});return t}function J(e){var t=e.dy*100,n=t<270?70:400;return n}function K(e,t,n,r){var i=t,s=e,o=d3.selectAll("rect"),u=i.sourceName,a=i.targetName;s.transition().duration(J(i)).style(y.link_hovered);d3.timer.flush();n=d3.selectAll("path").filter(function(e){return e!==i});n.transition().delay(750).duration(1e3).style(y.link_not_hovered);r=o.filter(function(e){var t=e.name===u,n=e.name===a;if(t){return false}else if(n){return false}else{return true}});r.transition("node").duration(1e3).style(g.node_not_from_link);et(t)}function Q(e){var t=d3.selectAll("path"),n=d3.selectAll("rect"),r=e,i;r.transition().style(y.link_reset_style_1).duration(1500).style(y.link_reset_style_2);d3.timer.flush();i=t.filter(function(t){return t!==e.datum()});i.transition().duration(900).style(y.link_init_style);n.transition("node").duration(1500).style(X[0]);rt()}function G(e,t,n,r,i){i=v.filter(function(e){var n=e.sourceName===t,r=e.targetName===t;if(!n){return true}else if(!r){return true}else{return false}});i.transition().delay(150).duration(1500).style(y.link_not_from_node);r=v.filter(function(e){var n=e.sourceName===t,r=e.targetName===t;if(n){return true}else if(r){return true}else{return false}});r.transition().delay(110).duration(1500).style(y.link_from_node);n=u.filter(function(t){return t!==e});n.transition("node").delay(300).duration(1e3).style(g.node_not_hovered)}function Y(e,t,n,r,i){var s=t.name,o=0;e.transition("node").duration(2).style(g.node_hovered);d3.timer.flush();G(t,s,n,r,i);nt(t)}function Z(e){var t=d3.selectAll("path"),n,r=0;e.transition("node").duration(250).style(g.node_return);d3.timer.flush();t.transition().delay(110).duration(1500).style(y.link_init_style);n=u.filter(function(t){return t!==e.datum()});n.transition("node").delay(500).style(g.node_return);it()}function et(t){var n=t.st,r=t.tt,i=[].concat(n,r).sort(x),s=0,o=0,u={},a={},f=function(e){var t={};if(e.num===i[s]){s++}else{t=e;return t}},l=function(e){var t={};if(e.num===i[o]){o++;return e}else{t=e}};u=c.filter(l);u.transition("text").delay(1e3).style({"font-size":"17px",fill:"#000010","pointer-events":"none"}).attr("x",-6).attr("text-anchor","end").attr("transform",null).filter(b.filterWidth).attr("x",6+e.nodeWidth()).attr({"text-anchor":"start","pointer-events":"none"});a=c.filter(f);a.transition("text").delay(1e3).style({"fill-opacity":0,"pointer-events":"none"})}function tt(e,t){var n=0,r=[],i=0;e.forEach(function(e){e.forEach(function(e){if(e.y-n<t&&e.y-n>0){if(_(i)){r.push(e.num);i++}else{i=0}}else{i=0}n=e.y})});return r}function nt(t){var n=t.num,r=t.sTag,i=t.tTag,s=[].concat(n,r,i).sort(x),o=s.length,u=o>7?b.font_size_hover_group:"17px",a=0,f=0,l=0,h=[],p={},d={},v=function(e){var t={};if(e.num===s[a]){a++}else{t=e;return t}},m=function(e){var t={};if(e.num===s[l]){l++;t=e;h.push(t);return t}};d=c.filter(v);d.transition("text").delay(2e3).style({"fill-opacity":0,"pointer-events":"none"});p=c.filter(m);if(o<12){p.transition("text").delay(2e3).style({"font-size":u,fill:"#000010","pointer-events":"none"})}else{var g=M(h,"x","y","up"),y=tt(g,10).sort(x),w={},E=function(e){var t={};if(e.num===y[f]){f++;t=e;return t}};w=p.filter(E);p.transition("text").delay(2e3).style({"font-size":u,fill:"#000010","pointer-events":"none"});if(t.x>width/2||t.x===0){w.transition("text").delay(2e3).attr("y",function(e){return e.dy/2}).attr({x:-6,"text-anchor":"end"}).style({"font-size":u,fill:"#000010","pointer-events":"none"})}else{w.transition("text").delay(2e3).attr("y",function(e){return e.dy/2}).attr({x:6+e.nodeWidth(),"text-anchor":"start"}).style({"font-size":u,fill:"#000010","pointer-events":"none"})}}}function rt(){c.transition("text").delay(500).style({"fill-opacity":1,"font-size":b.font_size,fill:b.font_color,"pointer-events":"none"})}function it(){c.transition("text").delay(1e3).style({"fill-opacity":1,"font-size":b.font_size,fill:b.font_color,"pointer-events":"none"}).transition().attr("x",-6).attr("text-anchor","end").attr("transform",null).filter(b.filterWidth).attr("x",6+e.nodeWidth()).attr("text-anchor","start")}function st(e){var t=e.datum();if(t.type!=="link"){Y(e,t)}else{K(e,t)}}function ot(e){if(e.datum().type!=="link"){Z(e)}else{Q(e)}}function ut(){var e=d3.select(this);st(e)}function at(){var e=d3.select(this);ot(e)}var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w=d3.format(",.0f"),E=function(e){return"$"+N(e)},S=d3.scale.category20();t=P(myData);d=Object.create(H());var B=0;var j=0;var F=0;e=Object.create(d3.sankey());e.nodeWidth(30);e.nodePadding(4);e.size([width,height]);e.nodes(t.eachNode);e.links(t.eachLink);e.curvature(.01);e.layout();i=e.nodes();i.forEach(function(e,t){if(i[t].sTag.length===0){B+=i[t].value}});s=e.nodes();s.forEach(function(e,t){if(s[t].tTag.length===0){j+=s[t].value}});s.forEach(function(e,t){if(s[t].sTag.length>0&&s[t].tTag.length>0){F+=s[t].value}});n=Object.create(theTip());r=Object.create(theTip());var q=B;n.attr("class","theTip").html(function(e){var t=[e.name,"<br>","<strong>Total:</strong> <span style='color:#1A3013'>",E(e.value),"</span><br>","<span style='color:red; font: 14px'>",I(e.value/q*100,3),"% of Budget","<span>"],n=t.join("");return n});r.attr("class","theTip").html(function(e){var t=[e.sourceName," → ",e.targetName,"<br>","<strong>Total:</strong> <span style='color:#1A3013'>",E(e.value),"</span><br>","<span style='color:red; font: 14px'>",I(e.value/q*100,3),"% of Budget","<span>"],n=t.join("");return n});y={link_stroke_width:function(e){return Math.max(2,e.dy)},link_stroke_width_hover:function(e){return Math.max(4,e.dy)},link_color:function(e,t){if(e.value>3e6){return e.theColor}else{return d3.rgb(e.theColor).darker(2.5)}}};y.link_init_style={fill:"none","stroke-opacity":.15,"stroke-width":y.link_stroke_width,stroke:y.link_color};y.link_reset_style_1={"stroke-opacity":.15};y.link_reset_style_2={"stroke-width":y.link_stroke_width,stroke:y.link_color};y.link_hovered={"stroke-opacity":.6,"stroke-width":y.link_stroke_width_hover};y.link_not_hovered={"stroke-width":y.link_stroke_width,"stroke-opacity":.05};y.link_from_node={"stroke-opacity":.5,"stroke-width":y.link_stroke_width};y.link_not_from_node={"stroke-opacity":0,"stroke-width":y.link_stroke_width};o=Object.create(R());v=d3.selectAll("path");o.on("mouseover",ut).on("mouseout",at).on("mouseenter",r.show).on("mouseleave",r.hide).on("touchstart",n.show);f=Object.create(U());g={};var X=new Array(1);var V=function(e){var t=parseFloat(e.dy)*100,n=t<270?"6px":"2px";return n};X[0]={"stroke-opacity":1,"fill-opacity":.8,"shape-rendering":"crispEdges",overflow:"visible","stroke-width":"1px","z-index":1e3};g.node_hovered={"fill-opacity":.7,"stroke-width":V,"z-index":-100};g.node_not_hovered={"stroke-width":"1px","stroke-opacity":1,"fill-opacity":1e-6};g.node_from_link={"stroke-width":1+"px","stroke-opacity":1,"fill-opacity":.6};g.node_not_from_link={"stroke-opacity":.6,"stroke-width":"1px","fill-opacity":1e-6};g.node_return={"fill-opacity":.8,"stroke-opacity":1,"stroke-width":"1px"};f.attr("class","node").attr("height",function(e){return e.dy}).attr("width",e.nodeWidth()).style("fill",z).style("stroke",W).style(X[0]);f.on("mouseover",ut).on("mouseout",at).on("mouseenter",n.show).on("mouseleave",n.hide).on("touchstart",n.show);u=d3.selectAll("rect");a=Object.create($());b={};b.font_size=function(e){if(e.dy>50){return"15px"}else if(e.dy<=1.5){return"0px"}else if(e.dy<=3){return"8px"}else if(e.dy<=4){return"9.5px"}else if(e.dy<=8){return"11px"}else if(e.dy<=20){return"12.5px"}else{return"13px"}};b.font_size_hover_group=function(e){if(e.dy>50){return"17px"}else if(e.dy<=1.5){return"9px"}else if(e.dy<=3){return"10px"}else if(e.dy<=4){return"10px"}else if(e.dy<=8){return"13px"}else if(e.dy<=20){return"14px"}else{return"16px"}};b.font_color=function(e){if(e.dy>50){return"#000010"}else if(e.dy<=1.5){return"#9AADB2"}else if(e.dy<=3){return"#343F47"}else if(e.dy<=8){return"#252D33"}else if(e.dy<=20){return"#14191C"}else{return"#111417"}};b.font_opacity=function(e){if(e.dy<1.5){return 0}};b.label_style={"font-size":b.font_size,fill:"#000010","pointer-events":"none","z-index":10,"text-shadow":0+""+1+"px "+0+" #fff"};b.filterWidth=function(e){return e.x<width/2};a.append("text").attr("class","labels").attr("x",-6).attr("y",function(e){if(e.dy>1.5){return e.dy/2}else{return 4}}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(e){return e.name}).style(b.label_style).filter(b.filterWidth).attr("x",6+e.nodeWidth()).attr("text-anchor","start");c=d3.selectAll("text");l=Object.create($());var h=["Revenue Source","Fund","","Agency"];l.append("text").attr("x",e.nodeWidth()).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(e,t){if(e.y===0){return h.shift()}}).attr("y",function(e){return e.y-.8+"em"}).style("font-size",20+"px").filter(function(e){return e.x<width/1.2}).attr("x",0).attr("text-anchor","start");d.call(theTip)})()